<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº“å­˜æŸ¥è¯¢ - è¥¿è—ç”µä¿¡ä»“åº“ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../assets/css/pc-common.css">
</head>
<body>
    <div class="app-container">
        <aside class="sidebar">
            <div class="sidebar-header"><div class="sidebar-logo">ğŸ“¦</div><div class="sidebar-title">ä»“åº“ç®¡ç†ç³»ç»Ÿ</div></div>
            <nav class="sidebar-menu">
                <div class="menu-item" onclick="location.href='dashboard.html'"><span class="menu-item-icon">ğŸ </span><span>å·¥ä½œå°</span></div>
                <div class="menu-item" onclick="location.href='inbound-list.html'"><span class="menu-item-icon">ğŸ“¥</span><span>å…¥åº“ç®¡ç†</span></div>
                <div class="menu-item" onclick="location.href='outbound-list.html'"><span class="menu-item-icon">ğŸ“¤</span><span>å‡ºåº“ç®¡ç†</span></div>
                <div class="menu-item" onclick="location.href='approval-list.html'"><span class="menu-item-icon">âœ“</span><span>å®¡æ‰¹ç®¡ç†</span></div>
                <div class="menu-item active"><span class="menu-item-icon">ğŸ“Š</span><span>åº“å­˜æŸ¥è¯¢</span></div>
                <div class="menu-item" onclick="location.href='stats.html'"><span class="menu-item-icon">ğŸ“ˆ</span><span>ç»Ÿè®¡æŠ¥è¡¨</span></div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-header">
                <div class="header-left"><div class="breadcrumb"><span class="breadcrumb-item active">åº“å­˜æŸ¥è¯¢</span></div></div>
                <div class="header-right">
                    <div class="notification-btn"><span>ğŸ””</span><span class="notification-badge">2</span></div>
                    <div class="user-info"><div class="user-avatar">å¼ </div><span>å¼ ä¸‰</span></div>
                </div>
            </header>

            <div class="content-wrapper">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">åº“å­˜æ˜ç»†</div>
                        <button class="btn btn-default" onclick="exportToExcel(mockData.inventoryList, 'åº“å­˜æ˜ç»†')">å¯¼å‡ºExcel</button>
                    </div>

                    <div class="table-toolbar">
                        <div class="search-box">
                            <input type="text" class="form-input search-input" placeholder="æœç´¢ç‰©èµ„åç§°ã€ç¼–ç ..." id="searchInput" onkeyup="handleSearch()">
                            <select class="form-select" style="width: 150px;" onchange="handleSearch()">
                                <option value="">å…¨éƒ¨çŠ¶æ€</option>
                                <option value="1">æ­£å¸¸</option>
                                <option value="2">ä½åº“å­˜</option>
                                <option value="3">ç¼ºè´§</option>
                            </select>
                        </div>
                    </div>

                    <table id="dataTable">
                        <thead>
                            <tr>
                                <th>ç‰©èµ„ç¼–ç </th>
                                <th>ç‰©èµ„åç§°</th>
                                <th>åˆ†ç±»</th>
                                <th>è§„æ ¼å‹å·</th>
                                <th>ä»“åº“</th>
                                <th>å½“å‰åº“å­˜</th>
                                <th>åº“å­˜çŠ¶æ€</th>
                                <th>åº“å­˜é‡‘é¢</th>
                                <th>æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="../assets/js/mock-data.js"></script>
    <script src="../assets/js/common.js"></script>
    <script>
        function renderTable(data) {
            const tbody = document.querySelector('#dataTable tbody');
            let html = '';

            data.forEach(item => {
                const statusIcon = item.status === 3 ? 'â›”' : (item.status === 2 ? 'âš ï¸' : 'âœ“');
                html += `
                    <tr>
                        <td>${item.materialCode}</td>
                        <td>${item.materialName}</td>
                        <td>${item.category}</td>
                        <td>${item.spec}</td>
                        <td>${item.warehouseName}</td>
                        <td><strong>${item.quantity}</strong> ${item.unit}</td>
                        <td>${getStatusTag(item.status, statusIcon + ' ' + item.statusText, 'inventory')}</td>
                        <td class="text-primary">${formatMoney(item.amount)}</td>
                        <td><button class="btn btn-text" onclick="showStockDetail('${item.materialCode}')">åº“å­˜è¯¦æƒ…</button></td>
                    </tr>
                `;
            });

            if (data.length === 0) {
                html = '<tr><td colspan="9"><div class="empty-state"><div class="empty-icon">ğŸ“­</div><div class="empty-text">æš‚æ— æ•°æ®</div></div></td></tr>';
            }

            tbody.innerHTML = html;
        }

        function handleSearch() {
            const keyword = document.getElementById('searchInput').value.toLowerCase();
            const statusSelect = document.querySelector('.table-toolbar select');
            const statusFilter = statusSelect.value;

            let data = mockData.inventoryList;

            if (keyword) {
                data = data.filter(i =>
                    i.materialCode.toLowerCase().includes(keyword) ||
                    i.materialName.toLowerCase().includes(keyword)
                );
            }

            if (statusFilter) {
                data = data.filter(i => i.status === parseInt(statusFilter));
            }

            renderTable(data);
        }

        function showStockDetail(code) {
            const item = mockData.inventoryList.find(i => i.materialCode === code);
            if (!item) return;

            const content = `
                <div style="font-size: 14px;">
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 16px;">
                        <div><strong>ç‰©èµ„ç¼–ç ï¼š</strong>${item.materialCode}</div>
                        <div><strong>ç‰©èµ„åç§°ï¼š</strong>${item.materialName}</div>
                        <div><strong>åˆ†ç±»ï¼š</strong>${item.category}</div>
                        <div><strong>è§„æ ¼å‹å·ï¼š</strong>${item.spec}</div>
                        <div><strong>å•ä½ï¼š</strong>${item.unit}</div>
                        <div><strong>ä»“åº“ï¼š</strong>${item.warehouseName}</div>
                        <div><strong>å½“å‰åº“å­˜ï¼š</strong><span style="font-size: 20px; font-weight: 600;">${item.quantity}</span> ${item.unit}</div>
                        <div><strong>åº“å­˜çŠ¶æ€ï¼š</strong>${getStatusTag(item.status, item.statusText, 'inventory')}</div>
                        <div><strong>åº“å­˜é‡‘é¢ï¼š</strong><span class="text-primary">${formatMoney(item.amount)}</span></div>
                        <div><strong>å•ä»·ï¼š</strong>${formatMoney(item.price)}</div>
                        <div><strong>æœ€å°åº“å­˜ï¼š</strong>${item.minQuantity} ${item.unit}</div>
                        <div><strong>æœ€å¤§åº“å­˜ï¼š</strong>${item.maxQuantity} ${item.unit}</div>
                    </div>
                    <div style="border-top: 1px solid #f0f0f0; padding-top: 16px;">
                        <strong>è¿‘æœŸåŠ¨æ€ï¼š</strong>
                        <div style="margin-top: 12px; padding: 12px; background: #fafafa; border-radius: 4px; font-size: 13px; color: #8c8c8c;">
                            æš‚æ— åº“å­˜åŠ¨æ€è®°å½•ï¼ˆå®é™…ç³»ç»Ÿä¸­ä¼šæ˜¾ç¤ºè¿‘æœŸå…¥åº“/å‡ºåº“è®°å½•ï¼‰
                        </div>
                    </div>
                </div>
            `;

            showDetailModal('åº“å­˜è¯¦æƒ… - ' + item.materialName, content);
        }

        function init() {
            renderTable(mockData.inventoryList);
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
