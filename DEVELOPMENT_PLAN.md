# CT-Tibet-WMS 开发规划文档

## 📋 当前项目状态概览

**项目阶段**: 前后端联调阶段 (62%完成)
**前端服务**: http://localhost:4447 (Vue 3 + Element Plus)
**后端服务**: http://localhost:48888 (Spring Boot)
**数据库**: MySQL
**消息队列**: RabbitMQ (已禁用，开发环境不需要)

---

## 🤖 当前已有的 Agent 配置

### 1. Backend Architect Agent
**位置**: `.claude/agents/backend-architect.md`
**功能**: 后端架构设计和技术方案规划
**状态**: ✅ 已配置

### 2. 内置 Claude Code Agents (已使用)
在本次开发中实际使用的agents：

- **frontend-developer** - 前端页面开发和API对接
- **debugging-toolkit:debugger** - 路由系统调试
- **Explore agent** - 代码库探索和功能检查

---

## 📊 当前开发进度

### 后端开发 (90%完成) ✅

**已完成**:
- ✅ 基础架构搭建 (Spring Boot + MyBatis-Plus)
- ✅ 用户认证与授权 (Spring Security + JWT)
- ✅ 基础数据管理 API (物资、仓库、部门、用户)
- ✅ 入库单管理 API
- ✅ 出库单管理 API (直接出库 + 申请出库)
- ✅ 申请审批流程 API
- ✅ 库存管理 API
- ✅ 统计报表 API
- ✅ 数据库设计和表结构
- ✅ 日志记录系统 (Logback)
- ✅ 异常处理机制
- ✅ API文档 (Knife4j)

**待完成**:
- ⏸️ 消息通知功能 (RabbitMQ集成)
- ⏸️ 定时任务 (7天超时自动取消)
- ⏸️ 文件上传功能
- ⏸️ 数据导出功能 (Excel)
- ⏸️ 单元测试覆盖

### 前端开发 (62%完成) 🔄

**已完成** (18/29页面):

#### 基础数据管理 (4/4) ✅
- 物资管理 (列表、新建、编辑、删除)
- 仓库管理 (列表、新建、编辑、删除)
- 部门管理 (树形列表、新建、编辑、删除)
- 用户管理 (列表、新建、编辑、删除、重置密码)

#### 入库管理 (3/3) ✅
- 入库单列表
- 新建入库单
- 入库单详情

#### 出库管理 (4/4) ✅
- 出库单列表
- 直接出库
- 出库单详情
- 确认领取

#### 申请管理 (2/3) 🔄
- 我的申请列表 ✅
- 新建申请单 ✅
- 申请单详情 ⏸️

#### 工作台 (2/2) ✅
- Dashboard 统计页
- 工作台首页

**待完成** (11个页面):

1. **申请单详情** (1个) - 优先级: 🔴 高
2. **审批模块** (2个) - 优先级: 🔴 高
   - 待审批列表
   - 已审批列表
3. **库存模块** (2个) - 优先级: 🟡 中
   - 库存查询列表
   - 库存预警列表
4. **统计报表** (3个) - 优先级: 🟢 低
   - 入库统计
   - 出库统计
   - 库存统计
5. **其他功能** (3个) - 优先级: 🟢 低
   - 消息中心
   - 个人中心
   - 密码修改

---

## 🎯 下一步开发计划

### 第一阶段: 完成核心业务闭环 (优先级: 🔴 高)

**目标**: 实现完整的申请→审批→出库→领取业务流程

#### Week 1: 完成申请审批模块 (预计3天)

**任务列表**:
1. ✅ 申请单详情页面API对接
   - 查看申请明细
   - 显示审批状态和理由
   - 关联出库单链接

2. ✅ 待审批列表页面API对接
   - 分页查询待审批申请
   - 审批操作（通过/拒绝）
   - 库存检查
   - 审批对话框

3. ✅ 已审批列表页面API对接
   - 分页查询已审批记录
   - 按审批结果筛选
   - 显示审批理由

**关键技术点**:
- 审批状态流转逻辑
- 库存实时检查
- 审批后自动创建出库单
- 表单验证和确认对话框

**验收标准**:
- ✅ 能完整走通申请→审批→出库流程
- ✅ 审批通过后自动创建出库单
- ✅ 审批拒绝时必须填写理由
- ✅ 库存不足时给出明确提示

---

### 第二阶段: 完善库存管理 (优先级: 🟡 中)

#### Week 2: 库存查询和预警 (预计2天)

**任务列表**:
1. ✅ 库存查询列表页面
   - 按仓库/物资筛选
   - 实时库存数量
   - 库存状态标识
   - 库存流水记录

2. ✅ 库存预警页面
   - 预警等级分类（紧急/一般）
   - 预警阈值计算
   - 处理标记功能
   - 统计卡片展示

**关键技术点**:
- 库存计算逻辑
- 预警阈值判断
- 库存流水追踪
- 数据刷新策略

---

### 第三阶段: 统计报表和数据分析 (优先级: 🟢 低)

#### Week 3: 统计报表完善 (预计2天)

**任务列表**:
1. 入库统计页面
   - 时间范围统计
   - 按仓库/物资分组
   - ECharts图表展示
   - 数据导出功能

2. 出库统计页面
   - 出库类型统计
   - 按部门/人员分组
   - 趋势分析图表
   - 数据导出功能

3. 库存统计页面
   - 库存周转率
   - 库存占用分析
   - 预警趋势图
   - 数据导出功能

---

### 第四阶段: 辅助功能完善 (优先级: 🟢 低)

#### Week 4: 消息和个人中心 (预计2天)

**任务列表**:
1. 消息中心页面
   - 消息列表展示
   - 消息已读/未读
   - 消息类型筛选
   - 消息详情查看

2. 个人中心页面
   - 个人信息展示
   - 信息修改
   - 头像上传
   - 密码修改

3. 系统设置
   - 主题切换
   - 语言设置
   - 快捷键配置

---

## 🛠️ 建议添加的 Agent 配置

为了提高开发效率，建议添加以下专用agents：

### 1. Frontend API Integration Agent
**文件**: `.claude/agents/frontend-api-integration.md`
**功能**: 专门用于前端API对接工作
**用途**:
- 自动识别页面中的mock数据
- 生成标准的API调用代码
- 处理字段映射和数据转换
- 统一错误处理

**优先级**: 🔴 高

### 2. Testing Agent
**文件**: `.claude/agents/testing-automation.md`
**功能**: 自动化测试用例生成和执行
**用途**:
- 生成单元测试代码
- API接口测试
- E2E测试场景
- 测试覆盖率报告

**优先级**: 🟡 中

### 3. Database Agent
**文件**: `.claude/agents/database-optimizer.md`
**功能**: 数据库设计和优化
**用途**:
- SQL性能优化
- 索引建议
- 查询优化
- 数据迁移脚本

**优先级**: 🟢 低

### 4. Documentation Agent
**文件**: `.claude/agents/docs-generator.md`
**功能**: 自动生成技术文档
**用途**:
- API文档更新
- 用户手册生成
- 开发文档维护
- 注释规范检查

**优先级**: 🟢 低

---

## 📝 开发规范和最佳实践

### 代码规范
1. **前端**:
   - 使用 Vue 3 Composition API
   - 统一使用 async/await
   - 错误处理由 request.js 统一管理
   - 组件命名使用 PascalCase

2. **后端**:
   - RESTful API设计
   - 统一返回格式 Result<T>
   - 异常统一处理 GlobalExceptionHandler
   - 使用 Lombok 简化代码

### Git 提交规范
```
feat: 新功能
fix: 修复bug
docs: 文档更新
style: 代码格式调整
refactor: 重构
test: 测试相关
chore: 构建/工具链相关
```

### API对接规范
1. 字段映射表维护
2. 分页参数统一（pageNum, pageSize）
3. 日期格式统一（yyyy-MM-dd HH:mm:ss）
4. 状态码统一定义

---

## 🎯 短期目标 (1-2周)

### 本周目标 (Week 1)
**主题**: 完成核心业务闭环

- [ ] 申请单详情页面API对接
- [ ] 待审批列表页面API对接
- [ ] 已审批列表页面API对接
- [ ] 完整测试申请→审批→出库流程
- [ ] 修复已知bug

**成功标准**:
- 员工能成功提交申请
- 仓管能审批申请
- 审批通过后能正常领取物资
- 所有状态流转正确

### 下周目标 (Week 2)
**主题**: 完善库存管理

- [ ] 库存查询列表页面
- [ ] 库存预警页面
- [ ] 库存流水记录
- [ ] 预警阈值配置

---

## 🚀 中期目标 (3-4周)

1. **统计报表完善**
   - 三个统计页面API对接
   - ECharts图表优化
   - 数据导出功能

2. **用户体验优化**
   - 消息中心
   - 个人中心
   - 快捷操作

3. **系统稳定性**
   - 单元测试覆盖
   - 集成测试
   - 性能优化

---

## 📈 长期目标 (1-2个月)

1. **移动端开发** (uni-app)
   - 扫码入库/出库
   - 移动审批
   - 库存查询
   - 消息推送

2. **高级功能**
   - 报表自定义
   - 数据大屏
   - 多仓库支持
   - 供应商管理

3. **系统优化**
   - 缓存策略
   - 并发优化
   - 安全加固
   - 备份恢复

---

## 🔍 技术债务和改进点

### 当前已知问题
1. ⚠️ 路由权限控制暂时禁用（开发阶段）
2. ⚠️ 部分页面缺少loading状态
3. ⚠️ 错误提示不够友好
4. ⚠️ 缺少单元测试

### 性能优化点
1. 🎯 大列表虚拟滚动
2. 🎯 图片懒加载
3. 🎯 API请求缓存
4. 🎯 组件按需加载

### 安全加固
1. 🔒 XSS防护
2. 🔒 CSRF防护
3. 🔒 SQL注入防护
4. 🔒 敏感数据加密

---

## 💡 开发建议

### 立即执行
1. **完成申请审批模块** - 这是核心业务流程的关键
2. **添加 Frontend API Integration Agent** - 加速剩余页面开发
3. **编写测试用例** - 保证代码质量

### 短期规划
1. 完成库存模块
2. 优化用户体验
3. 补充文档

### 长期规划
1. 移动端开发
2. 数据分析和BI
3. 系统扩展性

---

## 📞 团队协作

### 前端开发
- 完成剩余11个页面的API对接
- 优化用户界面和交互
- 单元测试和E2E测试

### 后端开发
- 完善API文档
- 性能优化
- 安全加固
- 消息通知功能

### 测试
- 功能测试用例编写
- 压力测试
- 兼容性测试

---

## 📅 里程碑

### Milestone 1: 核心功能完成 (Week 2)
- ✅ 基础数据管理
- ✅ 入库管理
- ✅ 出库管理
- ✅ 申请管理
- 🔄 审批管理 (本周完成)

### Milestone 2: 完整功能上线 (Week 4)
- 🎯 库存管理
- 🎯 统计报表
- 🎯 消息中心
- 🎯 个人中心

### Milestone 3: 生产环境部署 (Week 6)
- 🎯 性能优化
- 🎯 安全加固
- 🎯 文档完善
- 🎯 用户培训

---

## 🎓 学习资源

### 技术文档
- Vue 3 官方文档: https://vuejs.org/
- Element Plus: https://element-plus.org/
- Spring Boot: https://spring.io/projects/spring-boot
- MyBatis-Plus: https://baomidou.com/

### 项目文档
- API文档: http://localhost:48888/doc.html
- 需求文档: `/docs/需求分析.md`
- 技术方案: `/CLAUDE.md`
- API对接指南: `/frontend-pc/API_INTEGRATION_COMPLETE_GUIDE.md`

---

**最后更新**: 2025-11-14
**下次评审**: 2025-11-21
**负责人**: Claude + 开发团队
