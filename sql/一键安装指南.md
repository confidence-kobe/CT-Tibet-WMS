# 数据库一键安装指南

## 🚀 最简单的安装方法

### 方法一：使用 MySQL Workbench（推荐）

1. **打开 MySQL Workbench**
2. **连接到本地 MySQL 服务器**
3. **点击 "File" → "Run SQL Script"**
4. **依次选择并执行以下文件：**
   - ✅ `create_database.sql` （创建数据库）
   - ✅ `schema.sql` （创建表结构）
   - ✅ `init_data.sql` （初始化数据）

### 方法二：使用 Navicat

1. **打开 Navicat for MySQL**
2. **连接到本地 MySQL**
3. **点击 "File" → "Open File"**
4. **依次打开并执行（按 F5）：**
   - ✅ `create_database.sql`
   - ✅ `schema.sql`
   - ✅ `init_data.sql`

### 方法三：使用 MySQL 命令行

**Windows PowerShell / CMD：**

```powershell
# 进入 SQL 目录
cd H:\java\CT-Tibet-WMS\sql

# 执行安装（会提示输入密码）
mysql -u root -p < create_database.sql
mysql -u root -p ct_tibet_wms < schema.sql
mysql -u root -p ct_tibet_wms < init_data.sql
```

**或者一次性执行：**

```powershell
cd H:\java\CT-Tibet-WMS\sql
Get-Content create_database.sql, schema.sql, init_data.sql | mysql -u root -p
```

### 方法四：MySQL Command Line Client

1. **打开 "MySQL 8.0 Command Line Client"**（开始菜单中）
2. **输入 root 密码登录**
3. **复制粘贴以下命令并回车：**

```sql
SOURCE H:/java/CT-Tibet-WMS/sql/create_database.sql;
SOURCE H:/java/CT-Tibet-WMS/sql/schema.sql;
SOURCE H:/java/CT-Tibet-WMS/sql/init_data.sql;
```

---

## ✅ 验证安装是否成功

在 MySQL 中执行以下查询：

```sql
-- 切换到数据库
USE ct_tibet_wms;

-- 检查表数量（应该是 17）
SELECT COUNT(*) AS 表数量
FROM information_schema.TABLES
WHERE TABLE_SCHEMA = 'ct_tibet_wms';

-- 检查数据
SELECT '部门' AS 类型, COUNT(*) AS 数量 FROM tb_dept
UNION ALL SELECT '角色', COUNT(*) FROM tb_role
UNION ALL SELECT '用户', COUNT(*) FROM tb_user
UNION ALL SELECT '物资', COUNT(*) FROM tb_material
UNION ALL SELECT '仓库', COUNT(*) FROM tb_warehouse
UNION ALL SELECT '库存', COUNT(*) FROM tb_inventory;
```

**预期结果：**

| 类型 | 数量 |
|------|------|
| 部门 | 8 |
| 角色 | 4 |
| 用户 | 5 |
| 物资 | 20 |
| 仓库 | 7 |
| 库存 | 20 |

**表数量：17**

---

## 🔑 初始账号信息

安装完成后可以使用以下测试账号：

| 用户名 | 密码 | 角色 | 姓名 | 部门 |
|--------|------|------|------|------|
| admin | 123456 | 系统管理员 | 系统管理员 | 西藏电信 |
| wl_admin | 123456 | 部门管理员 | 网运部管理员 | 网络运维部 |
| wl_warehouse | 123456 | 仓库管理员 | 李军 | 网络运维部 |
| wl_user1 | 123456 | 普通员工 | 张强 | 网络运维部 |
| wl_user2 | 123456 | 普通员工 | 王小明 | 网络运维部 |

**注意：** 除 `admin` 外的账号首次登录会要求修改密码。

---

## 📊 安装内容

### 17张数据表

**系统管理（5张）：**
- ✅ tb_user - 用户表
- ✅ tb_role - 角色表
- ✅ tb_dept - 部门表
- ✅ tb_menu - 菜单表
- ✅ tb_role_menu - 角色菜单关联表

**基础数据（2张）：**
- ✅ tb_material - 物资表
- ✅ tb_warehouse - 仓库表

**业务数据（8张）：**
- ✅ tb_inbound - 入库单表
- ✅ tb_inbound_detail - 入库明细表
- ✅ tb_outbound - 出库单表
- ✅ tb_outbound_detail - 出库明细表
- ✅ tb_apply - 申请单表
- ✅ tb_apply_detail - 申请明细表
- ✅ tb_inventory - 库存表
- ✅ tb_inventory_log - 库存流水表

**消息通知（1张）：**
- ✅ tb_message - 消息表

**系统日志（2张）：**
- ✅ tb_operation_log - 操作日志表
- ✅ tb_login_log - 登录日志表

### 初始化数据

- ✅ 8个部门（西藏电信 + 7个业务部门）
- ✅ 4个角色（系统管理员、部门管理员、仓库管理员、普通员工）
- ✅ 5个测试用户
- ✅ 20种物资（光缆、设备、配件、工具）
- ✅ 7个仓库（每个部门一个）
- ✅ 20条库存记录（网络运维部初始库存）
- ✅ 完整的菜单权限配置
- ✅ 示例业务数据（入库单、申请单）

---

## ❓ 常见问题

### Q1: 提示 "Access denied for user 'root'@'localhost'"

**原因：** 密码错误或 root 用户没有权限

**解决：**
- 确认 root 密码正确
- 或使用 MySQL Workbench / Navicat 等可视化工具

### Q2: 提示 "Unknown database 'ct_tibet_wms'"

**原因：** 数据库还未创建

**解决：** 确保先执行 `create_database.sql`

### Q3: 中文显示乱码

**原因：** 字符集问题

**解决：** 确保数据库字符集为 utf8mb4：
```sql
SHOW CREATE DATABASE ct_tibet_wms;
```

### Q4: 想要重新安装

**清空数据库：**
```sql
DROP DATABASE IF EXISTS ct_tibet_wms;
```
然后重新执行安装步骤。

---

## 📞 需要帮助？

如果安装遇到问题，请提供：
1. 错误信息截图
2. MySQL 版本（`SELECT VERSION();`）
3. 执行的具体步骤

---

**祝您安装顺利！🎉**
