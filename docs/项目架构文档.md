# 西藏电信仓库管理系统 - 项目架构文档

## 文档信息

| 项目 | 内容 |
|------|------|
| 系统名称 | 西藏电信仓库管理系统 (CT-Tibet-WMS) |
| 架构版本 | v1.0 |
| 文档状态 | 已完成 |
| 创建日期 | 2025-11-11 |
| 技术栈 | Spring Boot + Vue 3 + uni-app |

---

## 目录

1. [总体架构](#1-总体架构)
2. [后端架构](#2-后端架构)
3. [前端PC架构](#3-前端pc架构)
4. [小程序架构](#4-小程序架构)
5. [部署架构](#5-部署架构)
6. [开发规范](#6-开发规范)

---

## 1. 总体架构

### 1.1 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                         用户层                               │
├──────────────┬──────────────────┬──────────────────────────┤
│   PC管理端    │   小程序(仓管)    │   小程序(员工)            │
│   Vue 3      │    uni-app       │    uni-app              │
└──────┬───────┴────────┬─────────┴──────────┬───────────────┘
       │                │                     │
       └────────────────┼─────────────────────┘
                        │ HTTPS/WSS
┌───────────────────────▼─────────────────────────────────────┐
│                    网关层 (Nginx)                            │
│              - 反向代理                                       │
│              - 负载均衡                                       │
│              - SSL终止                                        │
└───────────────────────┬─────────────────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                  应用层 (Spring Boot)                        │
├─────────────────────────────────────────────────────────────┤
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
│  │ 认证授权  │  │ 用户管理  │  │ 物资管理  │  │ 仓库管理  │   │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘   │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐   │
│  │ 入库管理  │  │ 出库管理  │  │ 申请审批  │  │ 库存管理  │   │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘   │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐                 │
│  │ 统计报表  │  │ 消息通知  │  │ 系统管理  │                 │
│  └──────────┘  └──────────┘  └──────────┘                 │
└───────────────────────┬─────────────────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                    中间件层                                  │
├──────────────┬──────────────────┬──────────────────────────┤
│  Redis       │   RabbitMQ       │   Elasticsearch          │
│  缓存         │   消息队列        │   日志搜索                │
└──────────────┴──────────────────┴──────────────────────────┘
                        │
┌───────────────────────▼─────────────────────────────────────┐
│                    数据层                                    │
├──────────────┬──────────────────┬──────────────────────────┤
│  MySQL       │   MinIO/OSS      │   Backup                 │
│  业务数据     │   文件存储        │   数据备份                │
└──────────────┴──────────────────┴──────────────────────────┘
```

### 1.2 技术栈选型

#### 后端技术栈
- **核心框架**: Spring Boot 2.7.x
- **ORM框架**: MyBatis-Plus 3.5.x
- **安全框架**: Spring Security + JWT
- **数据库**: MySQL 8.0+
- **缓存**: Redis 6.0+
- **消息队列**: RabbitMQ 3.12+
- **文档**: Knife4j (Swagger)
- **工具**: Lombok, Hutool, Guava

#### 前端PC技术栈
- **核心框架**: Vue 3.3+
- **构建工具**: Vite 4.x
- **UI框架**: Element Plus 2.4+
- **状态管理**: Pinia 2.1+
- **路由**: Vue Router 4.x
- **HTTP**: Axios
- **图表**: ECharts 5.x
- **工具**: VueUse, Day.js

#### 小程序技术栈
- **跨平台框架**: uni-app
- **UI组件**: uView UI
- **状态管理**: Vuex
- **HTTP**: uni-app request

### 1.3 项目目录结构

```
CT-Tibet-WMS/
├── backend/                          # 后端项目
│   ├── src/
│   │   ├── main/
│   │   │   ├── java/
│   │   │   │   └── com/
│   │   │   │       └── ct/
│   │   │   │           └── wms/
│   │   │   │               ├── WmsApplication.java
│   │   │   │               ├── common/          # 公共模块
│   │   │   │               ├── config/          # 配置类
│   │   │   │               ├── controller/      # 控制器
│   │   │   │               ├── service/         # 业务层
│   │   │   │               ├── mapper/          # 数据访问层
│   │   │   │               ├── entity/          # 实体类
│   │   │   │               ├── dto/             # 数据传输对象
│   │   │   │               ├── vo/              # 视图对象
│   │   │   │               ├── enums/           # 枚举
│   │   │   │               ├── exception/       # 异常
│   │   │   │               ├── filter/          # 过滤器
│   │   │   │               ├── interceptor/     # 拦截器
│   │   │   │               └── utils/           # 工具类
│   │   │   └── resources/
│   │   │       ├── application.yml              # 主配置
│   │   │       ├── application-dev.yml          # 开发环境
│   │   │       ├── application-prod.yml         # 生产环境
│   │   │       ├── mapper/                      # MyBatis映射
│   │   │       └── static/                      # 静态资源
│   │   └── test/                                # 测试代码
│   ├── pom.xml                                  # Maven配置
│   └── README.md
│
├── frontend-pc/                      # PC前端项目
│   ├── src/
│   │   ├── api/                     # API接口
│   │   ├── assets/                  # 静态资源
│   │   ├── components/              # 公共组件
│   │   ├── layout/                  # 布局组件
│   │   ├── views/                   # 页面视图
│   │   ├── router/                  # 路由配置
│   │   ├── store/                   # 状态管理
│   │   ├── utils/                   # 工具函数
│   │   ├── styles/                  # 全局样式
│   │   ├── directives/              # 自定义指令
│   │   ├── App.vue
│   │   └── main.js
│   ├── public/
│   ├── package.json
│   ├── vite.config.js
│   └── README.md
│
├── frontend-mobile/                  # 小程序项目
│   ├── pages/                       # 页面
│   │   ├── warehouse/               # 仓管员页面
│   │   └── employee/                # 员工页面
│   ├── components/                  # 组件
│   ├── static/                      # 静态资源
│   ├── store/                       # 状态管理
│   ├── utils/                       # 工具函数
│   ├── uni_modules/                 # uni-app插件
│   ├── App.vue
│   ├── main.js
│   ├── manifest.json                # 应用配置
│   ├── pages.json                   # 页面配置
│   └── uni.scss                     # 全局样式
│
├── docs/                            # 文档
│   ├── 需求分析.md
│   ├── PRD-产品需求文档.md
│   ├── 数据库设计文档.md
│   ├── 原型设计文档.md
│   ├── API接口文档.md
│   └── 项目架构文档.md
│
├── sql/                             # 数据库脚本
│   ├── schema.sql
│   ├── init_data.sql
│   └── create_database.sql
│
├── prototype/                       # 原型文件
│
├── deploy/                          # 部署脚本
│   ├── docker/
│   ├── nginx/
│   └── scripts/
│
├── .gitignore
├── CLAUDE.md
└── README.md
```

---

## 2. 后端架构

### 2.1 分层架构

```
┌──────────────────────────────────────────┐
│          Controller Layer                │  ← HTTP请求入口
│  - 参数校验                              │
│  - 请求路由                              │
│  - 响应封装                              │
└────────────────┬─────────────────────────┘
                 │
┌────────────────▼─────────────────────────┐
│          Service Layer                   │  ← 业务逻辑层
│  - 业务处理                              │
│  - 事务管理                              │
│  - 权限校验                              │
└────────────────┬─────────────────────────┘
                 │
┌────────────────▼─────────────────────────┐
│          Mapper Layer                    │  ← 数据访问层
│  - SQL映射                               │
│  - CRUD操作                              │
└────────────────┬─────────────────────────┘
                 │
┌────────────────▼─────────────────────────┐
│          Database                        │  ← 数据持久化
│  - MySQL                                 │
└──────────────────────────────────────────┘
```

### 2.2 核心模块设计

#### 2.2.1 认证授权模块
```java
com.ct.wms.security
├── JwtAuthenticationFilter.java     # JWT认证过滤器
├── JwtTokenProvider.java            # Token生成/解析
├── SecurityConfig.java              # Security配置
├── UserDetailsServiceImpl.java     # 用户详情服务
└── LoginUser.java                   # 登录用户信息
```

#### 2.2.2 公共模块
```java
com.ct.wms.common
├── api/
│   ├── Result.java                  # 统一响应
│   ├── PageResult.java              # 分页响应
│   └── ResultCode.java              # 响应码
├── constant/
│   ├── CommonConstant.java          # 通用常量
│   └── RedisKeyConstant.java        # Redis键常量
├── exception/
│   ├── BusinessException.java       # 业务异常
│   ├── GlobalExceptionHandler.java  # 全局异常处理
│   └── ErrorCode.java               # 错误码
└── annotation/
    ├── Log.java                     # 操作日志注解
    └── PreAuthorize.java            # 权限注解
```

#### 2.2.3 业务模块设计

每个业务模块遵循相同结构:

```java
com.ct.wms.module.{moduleName}
├── controller/
│   └── {Module}Controller.java      # REST接口
├── service/
│   ├── I{Module}Service.java        # 服务接口
│   └── impl/
│       └── {Module}ServiceImpl.java # 服务实现
├── mapper/
│   └── {Module}Mapper.java          # MyBatis接口
├── entity/
│   └── {Module}.java                # 实体类
├── dto/
│   ├── {Module}CreateDTO.java       # 创建DTO
│   ├── {Module}UpdateDTO.java       # 更新DTO
│   └── {Module}QueryDTO.java        # 查询DTO
└── vo/
    ├── {Module}VO.java              # 列表视图
    └── {Module}DetailVO.java        # 详情视图
```

### 2.3 核心配置

#### 2.3.1 application.yml 主配置

```yaml
spring:
  profiles:
    active: dev
  application:
    name: ct-tibet-wms

  # 数据源配置
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/ct_tibet_wms?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai&useSSL=false
    username: root
    password: ${DB_PASSWORD:root}
    type: com.zaxxer.hikari.HikariDataSource
    hikari:
      minimum-idle: 5
      maximum-pool-size: 20
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  # Redis配置
  redis:
    host: localhost
    port: 6379
    password: ${REDIS_PASSWORD:}
    database: 0
    timeout: 3000
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: -1ms

  # RabbitMQ配置
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
    virtual-host: /wms

# MyBatis-Plus配置
mybatis-plus:
  mapper-locations: classpath*:/mapper/**/*.xml
  type-aliases-package: com.ct.wms.**.entity
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: false
    log-impl: org.apache.ibatis.logging.stdout.StdOutImpl
  global-config:
    db-config:
      id-type: AUTO
      logic-delete-field: deleted
      logic-delete-value: 1
      logic-not-delete-value: 0

# JWT配置
jwt:
  secret: ${JWT_SECRET:ct-tibet-wms-secret-key-2025}
  expiration: 7200  # 2小时
  refresh-expiration: 604800  # 7天

# 文件上传配置
file:
  upload-path: /data/wms/uploads
  max-size: 10485760  # 10MB

# 服务器配置
server:
  port: 8080
  servlet:
    context-path: /
  compression:
    enabled: true
```

#### 2.3.2 pom.xml 依赖配置

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
         http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.7.18</version>
        <relativePath/>
    </parent>

    <groupId>com.ct</groupId>
    <artifactId>ct-tibet-wms</artifactId>
    <version>1.0.0</version>
    <name>CT Tibet WMS</name>
    <description>西藏电信仓库管理系统</description>

    <properties>
        <java.version>11</java.version>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <mybatis-plus.version>3.5.5</mybatis-plus.version>
        <druid.version>1.2.20</druid.version>
        <jwt.version>0.11.5</jwt.version>
        <hutool.version>5.8.23</hutool.version>
        <guava.version>32.1.3-jre</guava.version>
        <knife4j.version>4.4.0</knife4j.version>
    </properties>

    <dependencies>
        <!-- Spring Boot Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!-- Spring Boot Security -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-security</artifactId>
        </dependency>

        <!-- Spring Boot Validation -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>

        <!-- Spring Boot AOP -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-aop</artifactId>
        </dependency>

        <!-- Spring Boot Redis -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>

        <!-- Spring Boot RabbitMQ -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-amqp</artifactId>
        </dependency>

        <!-- MyBatis-Plus -->
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>${mybatis-plus.version}</version>
        </dependency>

        <!-- MySQL Driver -->
        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!-- Druid -->
        <dependency>
            <groupId>com.alibaba</groupId>
            <artifactId>druid-spring-boot-starter</artifactId>
            <version>${druid.version}</version>
        </dependency>

        <!-- JWT -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-api</artifactId>
            <version>${jwt.version}</version>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-impl</artifactId>
            <version>${jwt.version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-jackson</artifactId>
            <version>${jwt.version}</version>
            <scope>runtime</scope>
        </dependency>

        <!-- Hutool -->
        <dependency>
            <groupId>cn.hutool</groupId>
            <artifactId>hutool-all</artifactId>
            <version>${hutool.version}</version>
        </dependency>

        <!-- Guava -->
        <dependency>
            <groupId>com.google.guava</groupId>
            <artifactId>guava</artifactId>
            <version>${guava.version}</version>
        </dependency>

        <!-- Knife4j (Swagger) -->
        <dependency>
            <groupId>com.github.xiaoymin</groupId>
            <artifactId>knife4j-openapi3-spring-boot-starter</artifactId>
            <version>${knife4j.version}</version>
        </dependency>

        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>

        <!-- Spring Boot Test -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>

    <build>
        <finalName>${project.artifactId}</finalName>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

---

## 3. 前端PC架构

### 3.1 项目结构

```
frontend-pc/
├── public/
│   ├── favicon.ico
│   └── index.html
│
├── src/
│   ├── api/                         # API接口模块
│   │   ├── request.js               # Axios封装
│   │   ├── auth.js                  # 认证接口
│   │   ├── user.js                  # 用户接口
│   │   ├── material.js              # 物资接口
│   │   ├── warehouse.js             # 仓库接口
│   │   ├── inbound.js               # 入库接口
│   │   ├── outbound.js              # 出库接口
│   │   ├── apply.js                 # 申请接口
│   │   ├── inventory.js             # 库存接口
│   │   └── statistics.js            # 统计接口
│   │
│   ├── assets/                      # 静态资源
│   │   ├── images/
│   │   ├── icons/
│   │   └── logo.png
│   │
│   ├── components/                  # 公共组件
│   │   ├── Breadcrumb/              # 面包屑
│   │   ├── Pagination/              # 分页
│   │   ├── TableFilter/             # 表格筛选
│   │   ├── ImageUpload/             # 图片上传
│   │   ├── MaterialSelector/        # 物资选择器
│   │   └── WarehouseSelector/       # 仓库选择器
│   │
│   ├── layout/                      # 布局组件
│   │   ├── AppLayout.vue            # 主布局
│   │   ├── Sidebar.vue              # 侧边栏
│   │   ├── Navbar.vue               # 顶部导航
│   │   └── TagsView.vue             # 标签页
│   │
│   ├── views/                       # 页面视图
│   │   ├── login/
│   │   │   └── index.vue            # 登录页
│   │   ├── dashboard/
│   │   │   └── index.vue            # 工作台
│   │   ├── material/
│   │   │   ├── list.vue             # 物资列表
│   │   │   └── form.vue             # 物资表单
│   │   ├── warehouse/
│   │   │   ├── list.vue
│   │   │   └── form.vue
│   │   ├── inbound/
│   │   │   ├── list.vue             # 入库单列表
│   │   │   ├── create.vue           # 新建入库单
│   │   │   └── detail.vue           # 入库单详情
│   │   ├── outbound/
│   │   │   ├── list.vue
│   │   │   ├── create.vue
│   │   │   └── detail.vue
│   │   ├── apply/
│   │   │   ├── list.vue             # 申请列表
│   │   │   ├── create.vue           # 新建申请
│   │   │   └── detail.vue           # 申请详情
│   │   ├── approval/
│   │   │   ├── list.vue             # 审批列表
│   │   │   └── detail.vue           # 审批详情
│   │   ├── inventory/
│   │   │   ├── list.vue             # 库存查询
│   │   │   └── detail.vue           # 库存详情
│   │   ├── statistics/
│   │   │   ├── overview.vue         # 数据概览
│   │   │   └── reports.vue          # 报表统计
│   │   └── system/
│   │       ├── user/
│   │       ├── role/
│   │       └── dept/
│   │
│   ├── router/                      # 路由配置
│   │   ├── index.js                 # 路由主文件
│   │   └── modules/                 # 路由模块
│   │       ├── material.js
│   │       ├── warehouse.js
│   │       ├── business.js
│   │       └── system.js
│   │
│   ├── store/                       # 状态管理
│   │   ├── index.js                 # Pinia主文件
│   │   └── modules/
│   │       ├── user.js              # 用户状态
│   │       ├── app.js               # 应用状态
│   │       ├── permission.js        # 权限状态
│   │       └── tagsView.js          # 标签页状态
│   │
│   ├── utils/                       # 工具函数
│   │   ├── auth.js                  # 认证工具
│   │   ├── validate.js              # 校验工具
│   │   ├── date.js                  # 日期工具
│   │   ├── export.js                # 导出工具
│   │   └── permission.js            # 权限工具
│   │
│   ├── styles/                      # 样式文件
│   │   ├── index.scss               # 全局样式
│   │   ├── variables.scss           # 变量
│   │   ├── mixin.scss               # 混入
│   │   └── transition.scss          # 过渡动画
│   │
│   ├── directives/                  # 自定义指令
│   │   ├── permission.js            # 权限指令
│   │   └── loading.js               # 加载指令
│   │
│   ├── App.vue                      # 根组件
│   └── main.js                      # 入口文件
│
├── .env.development                 # 开发环境变量
├── .env.production                  # 生产环境变量
├── .gitignore
├── index.html
├── package.json
├── vite.config.js
└── README.md
```

### 3.2 核心配置

#### 3.2.1 package.json

```json
{
  "name": "ct-tibet-wms-frontend",
  "version": "1.0.0",
  "description": "西藏电信仓库管理系统 - PC端",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "lint": "eslint . --ext .vue,.js,.jsx,.cjs,.mjs --fix"
  },
  "dependencies": {
    "vue": "^3.3.8",
    "vue-router": "^4.2.5",
    "pinia": "^2.1.7",
    "element-plus": "^2.4.3",
    "axios": "^1.6.2",
    "@element-plus/icons-vue": "^2.3.1",
    "echarts": "^5.4.3",
    "dayjs": "^1.11.10",
    "lodash-es": "^4.17.21",
    "@vueuse/core": "^10.6.1"
  },
  "devDependencies": {
    "@vitejs/plugin-vue": "^4.5.0",
    "vite": "^5.0.3",
    "sass": "^1.69.5",
    "eslint": "^8.54.0",
    "eslint-plugin-vue": "^9.18.1"
  }
}
```

#### 3.2.2 vite.config.js

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],

  resolve: {
    alias: {
      '@': resolve(__dirname, 'src')
    }
  },

  server: {
    port: 3000,
    open: true,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, '/api')
      }
    }
  },

  build: {
    outDir: 'dist',
    sourcemap: false,
    chunkSizeWarningLimit: 1500,
    rollupOptions: {
      output: {
        manualChunks: {
          'element-plus': ['element-plus'],
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          'echarts': ['echarts']
        }
      }
    }
  }
})
```

#### 3.2.3 .env.development

```bash
# 开发环境配置
VITE_APP_TITLE=西藏电信仓库管理系统
VITE_APP_BASE_API=http://localhost:8080/api
VITE_APP_UPLOAD_URL=http://localhost:8080/api/upload
```

#### 3.2.4 .env.production

```bash
# 生产环境配置
VITE_APP_TITLE=西藏电信仓库管理系统
VITE_APP_BASE_API=https://wms.chinatelecom.cn/api
VITE_APP_UPLOAD_URL=https://wms.chinatelecom.cn/api/upload
```

---

## 4. 小程序架构

### 4.1 项目结构

```
frontend-mobile/
├── pages/                           # 页面目录
│   ├── login/                       # 登录页
│   │   └── login.vue
│   │
│   ├── warehouse/                   # 仓管员页面
│   │   ├── home/                    # 首页
│   │   │   └── home.vue
│   │   ├── quick-inbound/           # 快速入库
│   │   │   └── quick-inbound.vue
│   │   ├── quick-outbound/          # 快速出库
│   │   │   └── quick-outbound.vue
│   │   ├── approval/                # 审批管理
│   │   │   ├── list.vue
│   │   │   └── detail.vue
│   │   └── inventory/               # 库存查询
│   │       └── list.vue
│   │
│   └── employee/                    # 员工页面
│       ├── home/                    # 首页
│       │   └── home.vue
│       ├── apply/                   # 申请管理
│       │   ├── list.vue
│       │   ├── create.vue
│       │   └── detail.vue
│       └── inventory/               # 库存查询
│           └── list.vue
│
├── components/                      # 组件目录
│   ├── MaterialCard/                # 物资卡片
│   ├── ApplyCard/                   # 申请卡片
│   ├── StatusTag/                   # 状态标签
│   └── EmptyState/                  # 空状态
│
├── static/                          # 静态资源
│   ├── images/
│   ├── icons/
│   └── logo.png
│
├── store/                           # 状态管理
│   ├── index.js
│   └── modules/
│       ├── user.js
│       └── app.js
│
├── utils/                           # 工具函数
│   ├── request.js                   # 请求封装
│   ├── auth.js                      # 认证工具
│   ├── validate.js                  # 校验工具
│   └── date.js                      # 日期工具
│
├── uni_modules/                     # uni-app插件
│   └── uview-ui/                    # uView UI
│
├── App.vue                          # 根组件
├── main.js                          # 入口文件
├── manifest.json                    # 应用配置
├── pages.json                       # 页面配置
├── uni.scss                         # 全局样式变量
└── package.json
```

### 4.2 核心配置

#### 4.2.1 manifest.json

```json
{
  "name": "西藏电信仓库管理",
  "appid": "__UNI__CTTIBET",
  "description": "西藏电信仓库管理系统小程序",
  "versionName": "1.0.0",
  "versionCode": "100",

  "mp-weixin": {
    "appid": "wxXXXXXXXXXXXXXXXX",
    "setting": {
      "urlCheck": false,
      "es6": true,
      "minified": true
    },
    "usingComponents": true
  },

  "h5": {
    "router": {
      "mode": "hash",
      "base": "/"
    }
  }
}
```

#### 4.2.2 pages.json

```json
{
  "easycom": {
    "autoscan": true,
    "custom": {
      "^u-(.*)": "uview-ui/components/u-$1/u-$1.vue"
    }
  },

  "pages": [
    {
      "path": "pages/warehouse/home/home",
      "style": {
        "navigationBarTitleText": "仓管员首页",
        "enablePullDownRefresh": true
      }
    },
    {
      "path": "pages/employee/home/home",
      "style": {
        "navigationBarTitleText": "员工首页",
        "enablePullDownRefresh": true
      }
    }
  ],

  "tabBar": {
    "color": "#8c8c8c",
    "selectedColor": "#1890ff",
    "backgroundColor": "#ffffff",
    "borderStyle": "black",
    "list": [
      {
        "pagePath": "pages/warehouse/home/home",
        "iconPath": "static/tabbar/home.png",
        "selectedIconPath": "static/tabbar/home-active.png",
        "text": "首页"
      },
      {
        "pagePath": "pages/warehouse/approval/list",
        "iconPath": "static/tabbar/approval.png",
        "selectedIconPath": "static/tabbar/approval-active.png",
        "text": "审批"
      },
      {
        "pagePath": "pages/warehouse/inventory/list",
        "iconPath": "static/tabbar/inventory.png",
        "selectedIconPath": "static/tabbar/inventory-active.png",
        "text": "库存"
      }
    ]
  },

  "globalStyle": {
    "navigationBarTextStyle": "black",
    "navigationBarTitleText": "仓库管理",
    "navigationBarBackgroundColor": "#ffffff",
    "backgroundColor": "#f5f5f5"
  }
}
```

---

## 5. 部署架构

### 5.1 Docker部署方案

#### 5.1.1 docker-compose.yml

```yaml
version: '3.8'

services:
  # MySQL数据库
  mysql:
    image: mysql:8.0
    container_name: wms-mysql
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      MYSQL_DATABASE: ct_tibet_wms
      TZ: Asia/Shanghai
    volumes:
      - ./data/mysql:/var/lib/mysql
      - ./sql:/docker-entrypoint-initdb.d
    ports:
      - "3306:3306"
    networks:
      - wms-network

  # Redis缓存
  redis:
    image: redis:6.2-alpine
    container_name: wms-redis
    restart: always
    command: redis-server --requirepass ${REDIS_PASSWORD}
    volumes:
      - ./data/redis:/data
    ports:
      - "6379:6379"
    networks:
      - wms-network

  # RabbitMQ消息队列
  rabbitmq:
    image: rabbitmq:3.12-management
    container_name: wms-rabbitmq
    restart: always
    environment:
      RABBITMQ_DEFAULT_USER: ${RABBITMQ_USER}
      RABBITMQ_DEFAULT_PASS: ${RABBITMQ_PASSWORD}
    volumes:
      - ./data/rabbitmq:/var/lib/rabbitmq
    ports:
      - "5672:5672"
      - "15672:15672"
    networks:
      - wms-network

  # 后端应用
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: wms-backend
    restart: always
    depends_on:
      - mysql
      - redis
      - rabbitmq
    environment:
      SPRING_PROFILES_ACTIVE: prod
      DB_HOST: mysql
      DB_PORT: 3306
      DB_PASSWORD: ${MYSQL_ROOT_PASSWORD}
      REDIS_HOST: redis
      REDIS_PASSWORD: ${REDIS_PASSWORD}
      RABBITMQ_HOST: rabbitmq
      RABBITMQ_USER: ${RABBITMQ_USER}
      RABBITMQ_PASSWORD: ${RABBITMQ_PASSWORD}
    volumes:
      - ./data/uploads:/data/wms/uploads
      - ./logs:/app/logs
    ports:
      - "8080:8080"
    networks:
      - wms-network

  # Nginx反向代理
  nginx:
    image: nginx:alpine
    container_name: wms-nginx
    restart: always
    depends_on:
      - backend
    volumes:
      - ./deploy/nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./deploy/nginx/conf.d:/etc/nginx/conf.d
      - ./frontend-pc/dist:/usr/share/nginx/html
      - ./deploy/nginx/ssl:/etc/nginx/ssl
    ports:
      - "80:80"
      - "443:443"
    networks:
      - wms-network

networks:
  wms-network:
    driver: bridge

volumes:
  mysql-data:
  redis-data:
  rabbitmq-data:
```

#### 5.1.2 后端Dockerfile

```dockerfile
# backend/Dockerfile
FROM openjdk:11-jre-slim

WORKDIR /app

# 复制jar包
COPY target/ct-tibet-wms.jar app.jar

# 暴露端口
EXPOSE 8080

# 健康检查
HEALTHCHECK --interval=30s --timeout=3s --start-period=40s \
  CMD curl -f http://localhost:8080/actuator/health || exit 1

# 启动应用
ENTRYPOINT ["java", \
  "-Djava.security.egd=file:/dev/./urandom", \
  "-Duser.timezone=Asia/Shanghai", \
  "-Xms512m", \
  "-Xmx1024m", \
  "-jar", \
  "app.jar"]
```

### 5.2 Nginx配置

#### 5.2.1 nginx.conf

```nginx
user nginx;
worker_processes auto;
error_log /var/log/nginx/error.log warn;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';

    access_log /var/log/nginx/access.log main;

    sendfile on;
    tcp_nopush on;
    keepalive_timeout 65;
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;

    include /etc/nginx/conf.d/*.conf;
}
```

#### 5.2.2 conf.d/wms.conf

```nginx
# API后端
upstream backend {
    server backend:8080;
}

# HTTP重定向到HTTPS
server {
    listen 80;
    server_name wms.chinatelecom.cn;
    return 301 https://$server_name$request_uri;
}

# HTTPS主配置
server {
    listen 443 ssl http2;
    server_name wms.chinatelecom.cn;

    # SSL证书配置
    ssl_certificate /etc/nginx/ssl/wms.crt;
    ssl_certificate_key /etc/nginx/ssl/wms.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers on;

    # 前端静态资源
    location / {
        root /usr/share/nginx/html;
        try_files $uri $uri/ /index.html;
        expires 7d;
        add_header Cache-Control "public, immutable";
    }

    # API代理
    location /api/ {
        proxy_pass http://backend/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # 超时设置
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;

        # 缓冲设置
        proxy_buffering off;
        proxy_request_buffering off;
    }

    # 文件上传
    location /api/upload {
        client_max_body_size 10M;
        proxy_pass http://backend/api/upload;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## 6. 开发规范

### 6.1 代码规范

#### 6.1.1 Java后端规范

**命名规范**:
- 类名: PascalCase (UserController, UserService)
- 方法名: camelCase (getUser, createUser)
- 常量: UPPER_SNAKE_CASE (MAX_SIZE, DEFAULT_PAGE)
- 包名: 全小写 (com.ct.wms.controller)

**注释规范**:
```java
/**
 * 用户控制器
 *
 * @author CT Development Team
 * @since 2025-11-11
 */
@RestController
@RequestMapping("/api/users")
public class UserController {

    /**
     * 获取用户详情
     *
     * @param id 用户ID
     * @return 用户详情
     */
    @GetMapping("/{id}")
    public Result<UserVO> getUser(@PathVariable Long id) {
        // 实现代码
    }
}
```

**异常处理**:
```java
// 业务异常
if (user == null) {
    throw new BusinessException(ErrorCode.USER_NOT_FOUND);
}

// 参数校验
@NotNull(message = "用户名不能为空")
@Size(min = 3, max = 20, message = "用户名长度必须在3-20之间")
private String username;
```

#### 6.1.2 Vue前端规范

**命名规范**:
- 组件名: PascalCase (UserList.vue, MaterialSelector.vue)
- 方法名: camelCase (getUserList, handleSubmit)
- 常量: UPPER_SNAKE_CASE (API_BASE_URL)

**组件结构**:
```vue
<template>
  <div class="user-list">
    <!-- 模板内容 -->
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'

// Props定义
const props = defineProps({
  userId: {
    type: Number,
    required: true
  }
})

// 响应式数据
const userList = ref([])

// 生命周期
onMounted(() => {
  fetchUserList()
})

// 方法
const fetchUserList = async () => {
  // 实现代码
}
</script>

<style scoped lang="scss">
.user-list {
  // 样式代码
}
</style>
```

### 6.2 Git规范

#### 6.2.1 分支管理

```
main              # 主分支,生产环境代码
├── develop       # 开发分支
│   ├── feature/user-management      # 功能分支
│   ├── feature/material-management
│   └── bugfix/login-error           # 修复分支
└── release/v1.0.0                   # 发布分支
```

#### 6.2.2 提交规范

```bash
# 格式: <type>(<scope>): <subject>

# 类型(type):
# - feat: 新功能
# - fix: 修复bug
# - docs: 文档更新
# - style: 代码格式调整
# - refactor: 重构
# - test: 测试
# - chore: 构建/工具变动

# 示例:
git commit -m "feat(user): 添加用户管理功能"
git commit -m "fix(login): 修复登录验证码错误"
git commit -m "docs(api): 更新API文档"
```

### 6.3 接口对接规范

#### 6.3.1 前后端接口约定

**请求格式**:
```javascript
// GET请求
axios.get('/api/users', {
  params: { pageNum: 1, pageSize: 20 }
})

// POST请求
axios.post('/api/users', {
  username: 'admin',
  password: '123456'
})
```

**响应格式**:
```javascript
// 成功响应
{
  "code": 200,
  "message": "操作成功",
  "data": { ... },
  "timestamp": 1699600000000
}

// 错误响应
{
  "code": 400,
  "message": "参数错误",
  "data": null,
  "timestamp": 1699600000000
}
```

#### 6.3.2 Mock数据规范

开发阶段使用Mock数据:
```javascript
// mock/user.js
export default [
  {
    url: '/api/users',
    method: 'get',
    response: () => ({
      code: 200,
      message: '查询成功',
      data: {
        total: 100,
        list: [
          { id: 1, username: 'admin', ... }
        ]
      }
    })
  }
]
```

### 6.4 测试规范

#### 6.4.1 单元测试

```java
@SpringBootTest
class UserServiceTest {

    @Autowired
    private IUserService userService;

    @Test
    void testGetUser() {
        UserVO user = userService.getById(1L);
        assertNotNull(user);
        assertEquals("admin", user.getUsername());
    }
}
```

#### 6.4.2 接口测试

使用Postman或JMeter进行接口测试,覆盖:
- 正常场景测试
- 异常场景测试
- 边界值测试
- 并发测试

---

## 7. 开发流程

### 7.1 环境准备

1. **安装开发工具**
   - JDK 11+
   - Maven 3.6+
   - Node.js 16+
   - MySQL 8.0+
   - Redis 6.0+
   - Git

2. **克隆项目**
```bash
git clone https://github.com/ct-tibet/wms.git
cd CT-Tibet-WMS
```

3. **初始化数据库**
```bash
cd sql
mysql -u root -p < create_database.sql
mysql -u root -p ct_tibet_wms < schema.sql
mysql -u root -p ct_tibet_wms < init_data.sql
```

### 7.2 后端启动

```bash
cd backend
mvn clean install
mvn spring-boot:run
```

访问: http://localhost:8080
API文档: http://localhost:8080/doc.html

### 7.3 前端启动

```bash
cd frontend-pc
npm install
npm run dev
```

访问: http://localhost:3000

### 7.4 小程序启动

```bash
cd frontend-mobile
npm install
# 使用HBuilderX打开项目并运行到微信开发者工具
```

---

## 8. 附录

### 8.1 常见问题

**Q: 数据库连接失败?**
A: 检查MySQL服务是否启动,配置文件中的数据库连接信息是否正确

**Q: Redis连接超时?**
A: 检查Redis服务是否启动,防火墙是否开放6379端口

**Q: 前端跨域问题?**
A: 开发环境已配置代理,生产环境通过Nginx解决

### 8.2 参考资料

- [Spring Boot官方文档](https://spring.io/projects/spring-boot)
- [Vue 3官方文档](https://vuejs.org/)
- [Element Plus文档](https://element-plus.org/)
- [uni-app官方文档](https://uniapp.dcloud.net.cn/)
- [MyBatis-Plus文档](https://baomidou.com/)

---

**文档版本: v1.0**
**最后更新: 2025-11-11**
**维护团队: 技术开发组**
