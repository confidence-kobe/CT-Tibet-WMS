╔══════════════════════════════════════════════════════════════════════════════╗
║                    逻辑删除字段映射统一修复 - 快速总结                          ║
╚══════════════════════════════════════════════════════════════════════════════╝

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 问题诊断
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  错误信息: Unknown column 'is_deleted' in 'field list'

  根本原因: Java字段名与MyBatis-Plus配置不一致

  ┌─────────────────┬──────────────────┬──────────────┐
  │    位置         │    期望值        │   实际值     │
  ├─────────────────┼──────────────────┼──────────────┤
  │ 配置文件        │ deleted          │ deleted   ✓  │
  │ BaseEntity      │ deleted          │ isDeleted ✗  │
  │ 数据库          │ is_deleted       │ is_deleted✓  │
  └─────────────────┴──────────────────┴──────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 修复方案
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  文件: backend/src/main/java/com/ct/wms/entity/BaseEntity.java

  修改前:  private Integer isDeleted;   ← 错误
  修改后:  private Integer deleted;     ← 正确

  修改行数: 1 行
  影响范围: 14 个实体类（通过继承自动修复）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 映射关系（修复后）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  application.yml                BaseEntity.java             数据库表
  ┌─────────────────┐           ┌─────────────────┐        ┌─────────────────┐
  │ logic-delete-   │           │  @TableLogic    │        │  `is_deleted`   │
  │ field: deleted  │──────────▶│  private Integer│───────▶│   TINYINT(1)    │
  │                 │  配置指定  │  deleted;       │ 驼峰转换│  DEFAULT 0      │
  └─────────────────┘           └─────────────────┘        └─────────────────┘
       (配置层)                       (Java层)                  (数据库层)

  核心原则: 配置的字段名 = Java字段名，MyBatis-Plus自动完成驼峰到蛇形转换

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 验证结果
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  ✓ 代码编译    mvn clean compile         成功
  ✓ 字段统一    所有实体类继承BaseEntity    一致
  ✓ 配置匹配    deleted = deleted          匹配
  ⏳ 功能测试   需要重启应用测试            待测试

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 下一步操作
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  1. 在IDEA中重启应用（Debug模式）
     └─ 右键 WmsApplication.java → Debug 'WmsApplication'

  2. 测试登录接口
     └─ POST http://localhost:48888/api/auth/login
        Body: {"username":"admin","password":"password123","loginType":1}

  3. 检查日志
     └─ 查看 backend/logs/debug-for-claude.log
        确认不再有 "Unknown column 'is_deleted'" 错误

  4. 测试逻辑删除
     └─ 删除一条记录，验证 is_deleted 字段是否正确更新为 1

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 最佳实践总结
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  ✓ DO: 让Java字段名与配置保持一致
        @TableLogic private Integer deleted;

  ✓ DO: 启用驼峰转换，让框架自动映射
        map-underscore-to-camel-case: true

  ✗ DON'T: 在@TableLogic字段上使用@TableField
        @TableLogic @TableField("is_deleted")  ← 会冲突！

  ✗ DON'T: Java字段名使用下划线
        private Integer is_deleted;  ← 违背命名规范！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 详细文档
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  完整分析报告: FIELD_MAPPING_FIX.md
  快速修复指南: QUICK_FIX_SUMMARY.md (如果存在)
  调试指南:     backend/IDEA-DEBUG-SETUP.md

╔══════════════════════════════════════════════════════════════════════════════╗
║  修复状态: ✓ 完成    验证状态: ✓ 编译通过    测试状态: ⏳ 待重启测试          ║
╚══════════════════════════════════════════════════════════════════════════════╝
